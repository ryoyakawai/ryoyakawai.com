<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>

<meta charset="utf-8">
<title>Delicious Days &#8211; Delicious Days</title>
<meta name="description" content="Ryoya Kawai's Life Blog">
<meta name="keywords" content="blog, ryoya, kawai, life">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="../images/background_sf_pano.jpg">

<meta name="twitter:description" content="Ryoya Kawai's Life Blog">


<!-- Open Graph -->
<meta property="og:locale" content="ja_JP">
<meta property="og:type" content="summary">
<meta property="og:image" content="../images/background_sf_pano_300x300.jpg">
<meta property="og:title" content="Delicious Days">
<meta property="og:description" content="Ryoya Kawai's Life Blog">
<meta property="og:url" content="../page10/">
<meta property="og:site_name" content="Delicious Days">





<link rel="canonical" href="../page10/">
<link href="../feed.xml" type="application/atom+xml" rel="alternate" title="Delicious Days Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="../assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="../assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Polymer -->
<script src="https://polygit.org/components/webcomponentsjs/webcomponents-loader.js"></script>
<link rel="import" href="../assets/components/youtube-play.html">
<link rel="import" href="../assets/components/language-selector.html">

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="../images/profile_photo.jpg">
<link rel="icon" type="image/jpeg" href="../images/profile_photo.jpg">



<!-- AdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9891854265132215",
    enable_page_level_ads: true
  });
</script>




  <link rel="stylesheet" type="text/css" href="../assets/css/header-title.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/post.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
   (adsbygoogle = window.adsbygoogle || []).push({
     google_ad_client: "ca-pub-9891854265132215",
     enable_page_level_ads: true
   });
  </script>
</head>

<body id="post-index" class="feature">

<!-- register service worker-->
<script type="text/javascript" src="register_sw.js"></script>

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="../">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="../images/avatar.jpg" alt="Ryoya Kawai photo" class="author-photo">
					<h4>Ryoya Kawai</h4>
					<p></p>
				</li>
				<li><a href="../about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:blog@ryoyakawai.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/ryoyakawai"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="https://facebook.com/ryoyakawai"><i class="fa fa-fw fa-facebook"></i> Facebook</a>
				</li>
				<li>
					<a href="https://google.com/+ryoyakawai"><i class="fa fa-fw fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="https://linkedin.com/in/ryoya-kawai-11342b57"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/ryoyakawai"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="../posts/">All Posts</a></li>
				<li><a href="../tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img class="entry-raw-image" src="../images/background_sf_pano.jpg">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1 class="header-title-text">Delicious Days</h1>
      <!--h2>Delicious Days</h2-->
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2013-10-13T00:00:00+09:00"><a href="../2013/10/13/camera-getusermedia.html">October 13, 2013</a></time></span><span class="author vcard"><span class="fn"><a href="../about/" title="About Ryoya Kawai">Ryoya Kawai</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute


      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="../2013/10/13/camera-getusermedia.html" rel="bookmark" title="プレゼン中に手元の実物を見せたいことありませんか？" itemprop="url">プレゼン中に手元の実物を見せたいことありませんか？</a></h1>
    
  </header>
  <div class="entry-content">
    <div> </div>

<p>プレゼンテーション中はスライドを表示してると思います。けど、そんな時に「実は、手元の実物を見せたい、、、」って思ったことはありまえんか？？<br />
僕は直前になるといろいろアイデアが浮かびプレゼン前に例えばデモを作ってることもありますf(^-^;) それと同じように、直前に「あっ、これ見せたほうが臨場感が伝わるよな。。。でも資料作成完了してて画像・動画は入れられないし、そもそも時間がない。。。(´・ω・｀)」という場合、「カメラを用意して、ケーブルを用意して、プレゼン中に切り替える？えっ、それ失敗したら悲惨だな〜」とか物理的にも、気分的にも大変ですよね。<br />
そんな場合、ネットにつながっているorお使いのコンピュータにWebサーバが動いている場合に使えるのが今回ご紹介するWeb Cameraとブラウザを使う方法です。</p>

<p>早速、それが<a href="http://goo.gl/kUJ98e" target="_blank">こちら</a></p>

<div class="post-image-center">
  <img src="../images/2013/10/20131013-camera-gum.png" width="80%" />
</div>

<p>使い方は超簡単の2Step。</p>

<ol>
  <li>Web CameraをPCに接続（PC内蔵のCameraも使えます）</li>
  <li><a href="http://goo.gl/kUJ98e">ココ</a>にアクセス、表示されたウィンドウ内のどこかをクリック</li>
</ol>

<p>以上です^^<br />
あとは見せたい実物をCameraで映すだけ！！<br />
PCに複数Cameraが接続されている場合はアドレスバーの右に出てくるカメラのマークをクリックすると選択できます。(Chrome)</p>

<div class="post-image-center">
  <img src="../images/2013/10/20131013-gum-02.png" width="50%" />
</div>

<p>これWebRTCで定義されているgetUserMedia()というAPIを使っています。気になる方はソース見てみてくださいね〜</p>

<p>（Web CameraはiBuffaloの<a href="http://buffalo.jp/products/catalog/supply/multimedia/webcamera/320/bsw32km03/" target="_blank">BSW32KM03BK</a>を使ってます。）</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2013-09-05T00:00:00+09:00"><a href="../2013/09/05/web-midi-event.html">September 05, 2013</a></time></span><span class="author vcard"><span class="fn"><a href="../about/" title="About Ryoya Kawai">Ryoya Kawai</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute


      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="../2013/09/05/web-midi-event.html" rel="bookmark" title="ついに旬がきた？！ Web Audio / Web MIDI 関連のイベントが目白押しです！！" itemprop="url">ついに旬がきた？！ Web Audio / Web MIDI 関連のイベントが目白押しです！！</a></h1>
    
  </header>
  <div class="entry-content">
    <div> </div>

<p>9月5日のGDL(Google Developers Live)はご覧になられましたか？
「WebAudioAPIを使った音の扱い方」というタイトルで<a href="//twitter.com/g200kg" target="_blank">g200kg</a>さんが出演されました。
基本的な使い方から、WebAudioAPIが実装されていないブラウザから使う為の
Polyfill：<a href="https://github.com/g200kg/WAAPISim" target="_blank">WAAPIShim</a> についての説明と、とても詳しくご説明くださりかなり勉強になりました！</p>

<div>
  <youtube-play contentid="sMoQHFz2AMo" size="80%" imgsrc="../images/2013/09/20130905-webaudio.png" start="0" autoplay="1" rel="0" controls="1" showinfo="0" allowfullscreen="1"></youtube-play>
</div>

<p>そして次回、えーじさんからの告知がありました通りWeb MIDI APIについてになります。内容は以下を予定しています。</p>

<ul>
  <li>MIDIの歴史やユースケース、仕様の説明</li>
  <li>Web MIDI APIの使い方</li>
  <li>Web MIDI API Wrapperの説明</li>
</ul>

<p>さらに、何よりもChromeで実装を担当されています豊島さんもご一緒してくださり、とても豪華な感じになると思いますので、ご興味のある方はぜひ御覧くださいね^^</p>

<p>また「Hackathonもします」と告知もありましたが、日程は10月19日、場所はGoogle Japanオフィスでやりますよ！！
お題は「Web Audio API、Web MIDI API を使ったアプリケーションを作る」です。募集開始はもう少し先になってしまいますが、お楽しみにしててください^^
参加を迷ってしまいそうな方は、募集開始までにHackする具体的なアイデアとか、Hackする方向性とかをモヤっと考えてるとアイデアが降りてくるかもしれないですよ！</p>

<p>一例ですが、こんなのも作れちゃうんです！</p>

<h4 id="アプリケーションの事例">アプリケーションの事例</h4>
<ul>
  <li><a href="http://aikelab.net/pg01/" target="_blank">PowerChord Guitars</a><br /></li>
  <li><a href="http://www.g200kg.com/teburin/" target="_blank">Air Teburin</a><br /></li>
  <li><a href="http://db.tt/i8HuvYfI" target="_blank">HE MIDI</a></li>
</ul>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2013-08-24T00:00:00+09:00"><a href="../2013/08/24/webmidiapi-wrapper-02.html">August 24, 2013</a></time></span><span class="author vcard"><span class="fn"><a href="../about/" title="About Ryoya Kawai">Ryoya Kawai</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute


      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="../2013/08/24/webmidiapi-wrapper-02.html" rel="bookmark" title="Web MIDI API Wrapper 公開したよ ^^v (2)" itemprop="url">Web MIDI API Wrapper 公開したよ ^^v (2)</a></h1>
    
  </header>
  <div class="entry-content">
    <div> </div>

<p><a href="../2013/08/webmidiapi-wrapper.html" target="_blank">前回</a>に引き続き <a href="https://github.com/ryoyakawai/WebMIDIAPIWrapper" target="_blank">Web MIDI API Wrapper</a> についての説明です。今回は具体的な MIDI メッセージの送信の方法になります。</p>

<p>本題の前に、またまた MIDI ってどこで使われているかコーナーです。
MIDI には Show Control(MSC) という仕様があります。
前回の Universal Studio の Water World も MSC の一例でした。今回もその続きです。
そして Showといえば、Las Vegas かな？っていう勝手な想いがありまして、
今回はそこで利用されている例です。<a href="http://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%B3%E3%82%BA11" target="_blank">映画 Ocean’s Eleven</a> って御存知ですか？？
Las Vegas のカジノに泥棒に入るっていうストーリーですが、
最後のシーンで噴水ショーがが出てくるんです。あれが Las Vegas の
ベラージオ (<a href="http://www.bellagiolasvegas.com/ja/" target="_blank">Bellagio</a>) のショーというのは有名だと思います。なんと、あのコントロールのオリジナルのシステムは MIDI なんですよ〜！！</p>

<div>
  <youtube-play contentid="401wv1eKc2c" size="80%" imgsrc="../images/2013/08/20130824-fountain.png" start="0" autoplay="1" rel="0" controls="1" showinfo="0" allowfullscreen="1"></youtube-play>
</div>

<p>さて、本題です。前回もお伝えしましたが、Web MIDI API Wrapperは基本的な以下のメッセージに対応にしています。</p>

<ul>
  <li>NoteOn：音を鳴らす</li>
  <li>NoteOff：音を止める</li>
  <li>PitchBend：ピッチを上下させる</li>
  <li>Sustain：ダンパーペダルの操作</li>
  <li>Modulation：揺らぎ</li>
  <li>AllSoundOff：残響、Sustainを含め即時に全ての音を止める</li>
  <li>ResetAllController：PitchBend、After-Touchなどのコントローラを初期値に戻す</li>
  <li>AllNoteOff：発音している音を全て止める</li>
</ul>

<p>ということで、まずは NoteOn/NoteOff についてです。
NoteOnは「音を発音させてね」、NoteOffは「発音している音を停止させてね」
を知らせる Message です。えっ「コンピュータで音を鳴らすんだから、
例えばNoteOnの時にどれだけ長さ(時間)音を出すか指定しちゃえばいいじゃない。」
という印象をお持ちの方もいらっしゃると思いますが、もともと MIDI というのは電子楽器と電子楽器を
つなげ相互にコントロールを可能とする Protocol なので、コンピュータなら最初から音を出す時間を指定できちゃいますが、
リアルタイムの演奏ではそれはできないですよね〜、というところから NoteOn、NoteOff に分かれているのです。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendNoteOn</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">note</span><span class="p">,</span> <span class="nx">velocity</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>note：鳴らすnote番号を指定</li>
  <li>velocity：鳴らすnoteのvelocityを指定</li>
  <li>time：音を鳴らすタイミング(いつ音を鳴らすかをミリ秒で指定)</li>
</ul>

<p>NoteOnのvelocityに関して：velocityを直訳すると「速さ、速力」ですが、MIDI機器側では音の強弱に割り当てられている場合がほとんどです。数値の目安は1：ppp、64：mpとmfの中間、127：fff というのが目安です。
note番号に関して：中央のC(C4：ド)を60として白鍵、黒鍵関係なく鍵盤1つに対して数字が割り当てられています。
よって、88鍵ですと21〜108まで割り当てられていることになります。
例えばC4の右隣の白鍵D4は62、その間にある黒鍵は61です。<a href="http://upload.wikimedia.org/wikipedia/commons/7/7a/NoteNamesFrequenciesAndMidiNumbers.svg" target="_blank">note番号の図</a>  右にスクロールすると見えてきます。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendNoteOff</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">note</span><span class="p">,</span> <span class="nx">velocity</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>note：停止するnote番号を指定</li>
  <li>velocity：停止するnoteのvelocityを指定</li>
  <li>time：音を停止するタイミング(いつ音を鳴らすかをミリ秒で指定)</li>
  <li>NoteOffのvelocityに関して：鍵盤から手を離す速度と認識する機器もあり、その場合は音の余韻の長さを指定できます。NoteOnのvelocityをゼロにしてNoteOffの代わりにすることも可能です。
<br />
<br /></li>
</ul>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendProgramChange</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">programNo</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>programNo：変更する音色番号</li>
  <li>time：適応するタイミング(いつ音色を変更するかミリ秒で指定)</li>
</ul>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">setPitchBendValue</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">center</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：設定するMIDI機器(Port)を指定</li>
  <li>min：PitchBendの最小値</li>
  <li>max：PitchBendの最大値</li>
  <li>center：PitchBendの中央値(PitchBendがかかっていない状態)</li>
  <li>PitchBendに関して：範囲は16383と決まっていますが、MIDI機器によって中央を0、または中央が8192と違う場合があります。Web MIDI API Wrapperの初期設定値は中央：8192、最小：0、最大：16383 としています。</li>
  <li>sendPitchBend(portNo, ch, value, time);</li>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>value：適応するPitchBendの値を指定</li>
  <li>time：適応するタイミング(いつPitchBendを適応すかをミリ秒で指定)</li>
</ul>

<p>数値に関してはここが参考になると思います。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendSustainStatus</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>status：Sustainの指定を”on”、”off”で指定</li>
  <li>time：適応するタイミング(いつSustainを適応すかをミリ秒で指定)</li>
</ul>

<p>Sustainとは：ピアノで言うと一番右のペダルを踏んだ時の効果です。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendModulationValue</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>value：Modulationのかけ具合を数値で指定</li>
  <li>time：適応するタイミング(いつModulationを適応すかをミリ秒で指定)</li>
</ul>

<p>Modulationとは：音の揺らぎです。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">endAllSoundOff</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>time：適応するタイミング(いつallSoundOffを適応すかをミリ秒で指定)</li>
  <li>Sustainが動作していて、残響があったとしても即座に全ての音を停止する。AllNoteOffよりも強力。
<br />
<br /></li>
</ul>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendAllNoteOff</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>time：適応するタイミング(いつallNoteOffを適応すかをミリ秒で指定)</li>
</ul>

<p>その名の通りで、全てのNoteOnをNoteOffにする。よって、Sustainが動作していて残響ある場合はこの範囲ではない。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendResetAllController</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">ch</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>ch：送信先のMIDI機器(portNoで指定)のチャンネルを指定</li>
  <li>time：適応するタイミング(いつResetAllControllerを適応すかをミリ秒で指定)</li>
</ul>

<p>PitchBend, After-Touch等のコントローラを初期値に戻す。 
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sendRaw</span><span class="p">(</span><span class="nx">portNo</span><span class="p">,</span> <span class="nx">msg</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>portNo：送信先のMIDI機器(Port)を指定</li>
  <li>msg：送信するMIDIメッセージをArray型で指定</li>
  <li>time：適応するタイミング(いつSustainを適応すかをミリ秒で指定)
生のMIDIメッセージを送ることができます。例えばSysExを送信します。</li>
</ul>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">initializePerformanceNow</span><span class="p">();</span>
</code></pre>
</div>

<p>時間を初期化して、現在をスタート時間とします。再生する前に必ず実行してください。</p>

<p>さて、以上が Web MIDI API Wrapper が現状サポートしている MIDI メッセージになります。それでは引き続き実際に、 NoteOn/NoteOff と ProgramChange で馴染みのあるだろうこんなのを作ってみました。
<br />
<br /></p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="cm">/** 
 * 前回からの引き続きですので、Constructor は引き継いていでいます。
 * 詳しくは前回のPOSTを御覧ください。 
 */</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">initializePerformanceNow</span><span class="p">();</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendProgramChange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">);</span>

<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">120</span><span class="p">);</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">240</span><span class="p">);</span>

<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">240</span><span class="p">);</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">);</span>
</code></pre>
</div>

<p>詳しく見てみます。</p>

<ul>
  <li>5行目：時間を初期化</li>
  <li>6行目：音色を12（マリンバ）に変更</li>
  <li>8, 9行目：D4(レ)を120ms鳴らす</li>
  <li>11, 12行目：A4(ラ)を120ms鳴らす</li>
  <li>14, 15行目：D5(レ)を120ms鳴らす</li>
</ul>

<p>ということが行われています。
実際にどうなるかというのは <a href="https://dl.dropboxusercontent.com/u/695740/WebMIDIAPIWrapper/index.html" target="_blank">デモページ</a> のここ▼に実装してありますので試してみてください。多分聞いたことがあると思いますよ。</p>

<div class="post-image-center">
  <img src="../images/2013/08/20130824-webmidiapiwrapper-demo.png" width="80%" />
</div>

<p>では今回はこの辺にして、次回は初心に戻り、素で Web MIDI API を使う場合について説明していこうと思います！！</p>

<p>お楽しみに^^v
<br />
<br /></p>

<p>[更新履歴] 2013/08/26 sendRaw() の説明を追加しました。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2013-08-22T00:00:00+09:00"><a href="../2013/08/22/web-midi-api-send.html">August 22, 2013</a></time></span><span class="author vcard"><span class="fn"><a href="../about/" title="About Ryoya Kawai">Ryoya Kawai</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute


      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="../2013/08/22/web-midi-api-send.html" rel="bookmark" title="Web MIDI API の Send ももうすぐ来そうです!!" itemprop="url">Web MIDI API の Send ももうすぐ来そうです!!</a></h1>
    
  </header>
  <div class="entry-content">
    <div> </div>

<p><a href="http://www.google.co.jp/intl/ja/chrome/browser/canary.html" target="_blank">Google Chrome Canary</a> には
Web MIDI API の MIDI INPUT 機能が実装されていますが、
MIDI OUT 機能の実装はまだでした。が、それがもうすぐ来そうな予感です。
つまり Web MIDI API が完全体としてブラウザに実装されるということです。
何がいいかと言うと、JavaScript でプログラムを書けばブラウザから MIDI 機器をブリブリ操作できるようになるところです。
「MIDI 機器をコンピュータから操作する場合って <a href="http://japan.steinberg.net/" target="_blank">Cubase</a>、<a href="https://www.apple.com/jp/logic-pro/" target="_blank">Logic</a>、<a href="http://ja.wikipedia.org/wiki/Vision_(%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2)">Vision</a> とかの DAW からでしょ？」という固定概念がありそうですが、これからはWebブラウザから MIDI 機器を操作する時代がやってくるのです^^ 「でもそのJavaScriptとか操作って難しいんでしょ〜？」ってあたりは、
先日公開した <a href="https://github.com/ryoyakawai/WebMIDIAPIWrapper" target="_blank">Web MIDI API Wrapper</a> を使うと簡単に解決できると思いますよ！
（このブログで<a href="http://localhost:4000/2013/08/webmidiapi-wrapper.html" target="_blank">説明</a>もしています）</p>

<p>さて、本題の「もうすぐ来るよ」なところです。Google Chrome にはいくつかバージョンがあり、
ここで登場するものを説明すると、オープンソースの <a href="http://www.chromium.org/" target="_blank">Chromium</a>、正式公開じゃないから何が起こるか分からないバーションの
Google Chrome Canary、そして安定バージョンの <a href="http://www.google.co.jp/" target="_blank">Google Chrome</a>。なので API は最初に Chromium に実装され公開されます。そして今回 Web MIDI API の MIDI OUTPUT 機能の実装がされたのが Chromium です。ですので、近いうちには Google Chrome Canary に来そうだと思う訳です。</p>

<p>この MIDI OUTPUT の場合 SystemExclusive(SysEx)を使った場合のセキュリティの懸念があり、SysExを使うことを宣言すると許可を求めるダイアログが上がってきます。その状況がこれ▼になります。</p>

<div class="post-image-center">
  <img src="../images/2013/08/20130822-webmidi-permission-window.png" width="80%" />
</div>

<p>Web MIDI API での指定はこんな感じです。</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">navigator</span><span class="p">.</span><span class="nx">requestMIDIAccess</span><span class="p">(</span> <span class="p">{</span><span class="na">sysex</span><span class="p">:</span><span class="kc">true</span><span class="p">}</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">MIDISuccessCallback</span><span class="p">,</span> <span class="nx">MIDIErrorCallback</span> <span class="p">);</span>
</code></pre>
</div>

<p>「セキュリティの懸念って何？」というとこですが、 SysEx という MIDI Message はF0Hで始まりF7Hで終わる可変長で、楽器メーカー各社が独自に定めることのできるメッセージで、利用される代表例がユーザーがシンセサイザのプリセット音色のパラメータを変更して作成した音色データのバックアップだったりします。（同じメーカーであっても機種によって設定できるパラメータの数等に違いがあり出力フォーマットを統一することが困難な為、独自にフォーマットを定義できる SysEx を使います。）ここで、例えばシンセサイザが接続されたコンピュータ上のブラウザで動作している MIDI アプリケーションが音色パラメータを無断で SysEx を使って吸い出しサーバーに保存していたとしたらどうでしょう？このユーザーがアクセスする毎に照合するようにしたら個人名までは分からないですが「このユーザーは昨日アクセスしてきて、アレやってた人だ」というような特定ができちゃうことになりますよね。こういったことを未然に防止する為に、Web MIDI API ではアプリケーションが事前に SysEx を使うか否かを宣言し、ユーザーからの許可を取った上でしか利用できないという制限をしています。<br /></p>

<p>ちなみに、SysExについて「楽器メーカー各社が独自に定めることのできるメッセージ」
と書きましたが、SysEx を使うためには MIDI を管理する団体に届け出をして Manufactuere ID を取得する必要があり、
日本国内からは <a href="http://www.amei.or.jp/" target="_blank">AMEI(Association of Musical Electronics Industry：音楽電子事業協会)</a>、日本以外からは <a href="http://www.midi.org/" target="_blank">MMA(MIDI Manufacturers Association)</a>へ、ということになります。</p>

<p>現状で Manufactuere ID を保有している<a href="http://www.midi.org/techspecs/manid.php" target="_blank">団体のリスト</a>です。</p>

<p>いろいろ脱線してしまいましたが、という具合で Web MIDI API はもうすぐブラウザにやってきますよ！！！</p>

<p>(Web MIDI API Wrapper の説明の狭間に割り込んだPOSTになってしまいました(・ω&lt;))</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2013-08-20T00:00:00+09:00"><a href="../2013/08/20/webmidiapi-wrapper-01.html">August 20, 2013</a></time></span><span class="author vcard"><span class="fn"><a href="../about/" title="About Ryoya Kawai">Ryoya Kawai</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute


      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="../2013/08/20/webmidiapi-wrapper-01.html" rel="bookmark" title="Web MIDI API Wrapper 公開したよ^^ (1)" itemprop="url">Web MIDI API Wrapper 公開したよ^^ (1)</a></h1>
    
  </header>
  <div class="entry-content">
    <div> </div>

<p>2013年7月1日にChrome CanaryにMIDI InputがやってきたWeb MIDI API。そろそろOutputも来るはずですが、今のところ<a href="http://jazz-soft.net/" target="_blank">Jazz-Plugin</a>をインストールして<a href="https://github.com/cwilso/WebMIDIAPIShim" target="_blank">Web MIDI API Shim</a>を使って動かします^^
でも「MIDIって難しいんでしょ？」という声が聞こえて聞こえてきそうなので、聞こえてくる前にWrapperなるものを作ってみました。</p>

<div class="post-image-center">
<a href="https://github.com/ryoyakawai/WebMIDIAPIWrapper" target="_blank">Web MIDI API Wrapper</a>
</div>

<p>Wrapperの話に入る前に「MIDIってなんぞ？」ってところを少し書きます。一言で言うと
「メーカの枠を超え、電子楽器と電子楽器を接続する為のプロトコル」なんです。
歴史は30年前のNAMM Show(National Association of Music Merchants Show)という楽器の見本市でお披露目され
(今年はちょうど30周年に加え<a href="http://www.midi.org/aboutus/news/grammy.php" target="_blank">テクニカルグラミー賞を受賞</a>)、その後電子楽器の接続のみならず照明機器のコントロール、通信カラオケ、携帯電話の着信音の制作など幅広く利用、応用されています。有名なのは、HollywoodにあるUniversal StudiosのWaterworldのアトラクションで、ライトと演出の同期、キュー出しにMIDIが使われています。そのアトラクションがこれ▼です。(12分00秒辺りが同期とか必要そう)</p>
<div>
  <youtube-play contentid="GmkZYt2-GYY" size="80%" imgsrc="../images/2013/08/20130820-waterworld.png" start="0" autoplay="1" rel="0" controls="1" showinfo="0" allowfullscreen="1"></youtube-play>
</div>

<p>Wrapperの説明に入ります。
今のところ、とりあえずMIDIを意識せずともアプリケーションを簡単に構築できるように、基本的な以下のメッセージに対応にしています。</p>

<ul>
  <li>NoteOn：音を鳴らす</li>
  <li>NoteOff：音を止める</li>
  <li>PitchBend：ピッチを上下させる</li>
  <li>Sustain：ダンパーペダルの操作</li>
  <li>Modulation：揺らぎ</li>
  <li>AllSoundOff：残響、Sustainを含め即時に全ての音を止める</li>
  <li>ResetAllController：PitchBend、After-Touchなどのコントローラを初期値に戻す</li>
  <li>AllNoteOff：発音している音を全て止める</li>
</ul>

<p>使い方はこんな感じです。 まずは WebMIDIAPI.js と WebMIDIAPIWrapper.js にリンクします。(今回は都合上、前準備だけになってしまいました。。。)</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"[PathToJS]/WebMIDIAPI.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"[PathToJS]/WebMIDIAPIWrapper.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
</div>

<p>次にConstructorを作ります。</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">wmaw</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebMIDIAPIWrapper</span><span class="p">(</span> <span class="kc">false</span> <span class="p">);</span>
</code></pre>
</div>

<p>続いて MIDI Input 、 MIDI Output が指定されたときの EventHandler を指定します。</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">wmaw</span><span class="p">.</span><span class="nx">setMidiInputSelect</span><span class="o">=</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* MIDI Input の選択リストを表示する EventHandler */</span>
  <span class="cm">/* 選択リストから MIDI Input が選択された時の EventHandler もここに書く*/</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">wmaw</span><span class="p">.</span><span class="nx">setMidiOutputSelect</span><span class="o">=</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* MIDI Output の選択リストを表示する EventHandler */</span>
  <span class="cm">/* 選択リストから MIDI Output が選択された時の EventHandler もここに書く*/</span>
<span class="p">}</span>
</code></pre>
</div>

<p>最後に Web MIDI API を Fire する。</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">wmaw</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
</code></pre>
</div>

<p>これで MIDI Input、Output デバイスのリストが表示され、デバイスを選択できる状態になります。デバイスを選択した状態でMIDIメッセージを送れば音がなったりします。例えばこんな感じ▼</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">wmaw</span><span class="p">.</span><span class="nx">sendNoteOff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</code></pre>
</div>

<p>これでA4の音が500msecの間、60の強さ(最大127)で鳴ります。</p>

<p>ここから！というところですが、この先を書くと長くなりそうなので今回はここまでにして、次回はMIDIメッセージの送信について書こうと思います！！</p>

<p>お楽しみに^^</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="../page9/" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="..">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="../page8/">8</a></li>
      
    
      
        
        
        
        <li><a href="../page9/">9</a></li>
      
    
      
        <li><strong class="current-page">10</strong></li>
      
    
      
        
        
        
        <li><a href="../page11/">11</a></li>
      
    
      
        
        
        
        <li><a href="../page12/">12</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="../page15/">15</a></li>
    

    
    
      <li><a href="../page11/" class="btn">Next</a></li>
    
  </ul>
</div>


</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2019 Ryoya Kawai.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="../assets/js/scripts.min.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116678332-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116678332-1');
</script>





<script type="text/javascript" src="../assets/js/header-title-post-index.js"></script>

</body>
</html>
